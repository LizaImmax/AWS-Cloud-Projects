 Task 3: Configuring the Amazon Cognito user pool

 In this task, you create an Amazon Cognito user pool, create users, and update the application to use the user pool.

Task 3.1: Creating a user pool
In this task, you create an Amazon Cognito user pool, which is used as the identity provider to create users and manage user passwords. The Birds web application uses the tokens generated by the Amazon Cognito user pool to help ensure that users have authenticated and have a valid session before they can access a protected page or perform a protected action. Tokens are also used to authenticate administrators and provide access to the site administrator page.

On the AWS Management Console, in the search box, enter and choose Cognito to open the Amazon Cognito console.

In the navigation pane on the left, choose User pools.

Choose Create user pool.

On the Set up your application page, configure the following options:

For Application type, ensure that Traditional web application is already selected.

For Name your application: bird_app_client

Under the Configure options, choose Username

For Required attributes for sign-up, choose email from the dropdown.

For Add a return URL - optional, enter https://<cloudfront-domain>/callback.html, and replace <cloudfront-domain> with the CloudFront distribution domain from your text editor.

Note: The updated URL should be similar to the following: https://d123456acbdef.cloudfront.net/callback.html

Choose Create

On the next page, under Check out your sign-in page, choose View login page.

Notice the Sign-in page which you will configure later, close the browser tab.

Go back to the User pools and choose the pool you created.

User pool Name should be similar to User pool - zzzzzz

On the Overview: page, you notice the pool details and other configuraiton information.

Choose Rename and under User pool name enter bird_app, choose Save changes.

Copy the value for User pool ID to the editor.

From the bottom Recommendations pane, choose bird_app link.

Go to Login pages

On the Managed login pages configuration choose edit.

For OAuth 2.0 grant types, ensure that Authorization code grant is chosen.

From the dropdown list, choose Implicit grant.

For OpenID Connect scopes, ensure that Email and OpenID are chosen, and clear Phone.

Choose Save changes.

On the App client: bird_app page, copy the value for Client ID to the editor.

Choose Edit.

For Authentication flows, from the dropdown list, choose ALLOW_USER_PASSWORD_AUTH, and clear ALLOW_USER_SRP_AUTH.

Choose Save changes.

From the pane on the left, choose Domain

From the Domain copy the part of the URL after // and before .auth.us-east-1.amazoncognito.com, paste it into your editor against Amazon Cognito domain prefix:.

Note: The Cognito domain should look similar to us-east-1ozkgdmcoh

Next you create and add users to the user pool.






Task 3.2: Adding users to the user pool
From the navigation pane on the left, choose Overview.

Under User management choose Users

Choose Create user.

Create a user with the following details:

For User name, enter testuser.

For Password, enter Lab-password1$.

Choose Create user.

Create another user with the following details:

For User name, enter admin.

For Password, enter Admin123$.

Choose Create user.

Note: This user has administrator permissions.

From the navigation pane, under User management choose Groups.

Choose Create group.

On the Create group page for Group name, enter Administrators.

Choose Create group.

Choose the Administrators group that you created.

Choose Add user to group.

From the list of users, select admin.

Choose Add.

Note: You have added the admin user to the Administrators group.

To return to the earlier menu, choose the Overview from the navigation pane.






